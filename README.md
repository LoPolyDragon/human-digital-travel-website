# 唐代诗人游历轨迹可视化网站

基于真实Excel数据构建的唐代诗人游历轨迹可视化平台，使用 Next.js + FastAPI + Leaflet 技术栈。

## ✨ 功能特性

### 🗺️ 交互式地图
- 可视化展示诗人游历地点（古地名转今地名）
- 点击地点标记查看该地相关诗作
- 支持诗人和年份筛选功能
- 响应式设计，适配多种屏幕尺寸

### 👥 诗人信息管理
- 按朝代分类展示诗人（初唐、盛唐、中唐、晚唐）
- 显示诗人详细信息：活动年份、诗作数量、游历地点数
- 支持朝代筛选和年代排序
- 查看诗人代表作品

### 🛣️ 游历路线可视化
- 按时间顺序显示诗人游历轨迹
- 路线点标记显示年份和活动信息
- 动态切换显示/隐藏路线

### 🚗 唐代交通图层
- 显示唐代主要陆路干线（长安官道、丝绸之路等）
- 展示重要水路交通（黄河、大运河、长江水系）
- 区分道路等级：主干道、商贸道路、水路
- 鼠标悬停显示道路名称

## 🔧 技术栈

- **前端**: Next.js 14 + React 18 + TypeScript
- **地图**: Leaflet + OpenStreetMap
- **后端**: FastAPI (Python 3.8+)
- **数据**: JSON (从Excel处理生成)
- **样式**: CSS3 + 响应式设计

## 🚀 快速启动

### 方法一：使用启动脚本（推荐）

```bash
# 启动开发环境
./start_dev.sh

# 停止服务
./stop_dev.sh
```

### 方法二：手动启动

#### 1. 数据处理
```bash
# 处理Excel数据生成JSON文件
python3 scripts/process_excel_data.py
```

#### 2. 启动后端服务
```bash
cd backend
pip install -r requirements.txt
python3 main.py
```

#### 3. 启动前端服务
```bash
cd frontend
npm install
npm run dev
```

#### 4. 访问网站
- 前端：http://localhost:3000
- 后端API：http://localhost:8000
- API文档：http://localhost:8000/docs

## 📊 数据源

项目基于 **地理区分2.21** 文件夹中的191个Excel文件，包含：
- **86位唐代诗人**的详细活动记录
- **20,320个地点**信息（古今地名对照）
- **15,823首诗作**及其创作背景
- 时间跨度：618-907年（唐朝全时期）

### 数据字段说明
- `作家`：诗人姓名
- `公元年`：活动年份
- `古一级地名/古二级地名`：古代地名
- `今活动地省/今活动地市、县`：现代地名
- `系年作品`：诗作标题
- `活动`：诗人在该地的活动内容
- `体裁`：诗歌体裁

## 🌐 API 接口

### 诗人相关
- `GET /诗人` - 获取所有诗人统计信息
- `GET /路线/{诗人名}` - 获取指定诗人的游历路线

### 地点相关
- `GET /地点?poet=&year=` - 获取地点列表，支持筛选
- `POST /地点解析` - 古地名转换为今地名和坐标

### 诗作相关
- `GET /诗作?place_id=&poet=&year=` - 获取诗作列表，支持筛选
- `GET /年份范围` - 获取数据年份范围

## 📁 项目结构

```
唐代诗人游历轨迹网站/
├── backend/                    # FastAPI 后端
│   ├── main.py                # 主应用文件
│   └── requirements.txt       # Python 依赖
├── frontend/                   # Next.js 前端
│   ├── app/                   # 应用页面
│   │   ├── page.tsx          # 主页面
│   │   ├── layout.tsx        # 布局组件
│   │   └── globals.css       # 全局样式
│   ├── components/           # React 组件
│   │   ├── NavBar.tsx       # 导航栏
│   │   └── PoetInfo.tsx     # 诗人信息组件
│   └── package.json         # Node.js 依赖
├── data/                      # 数据文件
│   └── processed/            # 处理后的JSON数据
│       ├── poets.json       # 诗人数据
│       ├── places.json      # 地点数据
│       ├── poems.json       # 诗作数据
│       └── routes.json      # 路线数据
├── scripts/                   # 数据处理脚本
│   ├── process_excel_data.py # Excel转JSON脚本
│   └── check_excel_content.py # 数据检查脚本
├── 地理区分2.21/              # 原始Excel数据
├── logs/                      # 日志文件
├── start_dev.sh              # 开发环境启动脚本
├── stop_dev.sh               # 停止服务脚本
└── README.md                 # 项目说明
```

## 🎯 使用说明

### 地图视图
1. **选择诗人**：从下拉菜单选择特定诗人查看其游历地点
2. **年份筛选**：选择特定年份查看当年的诗人活动
3. **查看诗作**：点击地图上的地点标记，在弹窗中查看相关诗作
4. **显示路线**：选择诗人后点击"显示路线"查看游历轨迹
5. **交通图层**：点击"显示交通"查看唐代交通线路

### 诗人信息视图
1. **朝代筛选**：选择初唐、盛唐、中唐、晚唐查看不同时期诗人
2. **年代排序**：按时间顺序查看诗人信息
3. **统计信息**：查看各朝代诗人分布统计
4. **选择诗人**：点击诗人卡片可自动切换到地图视图

## 🔧 开发说明

### 数据更新
如需更新数据，将新的Excel文件放入 `地理区分2.21/` 目录，然后运行：
```bash
python3 scripts/process_excel_data.py
```

### 坐标配置
城市坐标在 `backend/main.py` 的 `CITY_COORDINATES` 中配置，可根据需要添加更多城市。

### 交通线路
唐代交通线路在 `frontend/app/page.tsx` 的 `唐代交通线` 中定义，基于历史资料配置。

## 📈 数据统计

- **诗人数量**：86位
- **地点记录**：20,320条
- **诗作记录**：15,823首
- **时间跨度**：289年（618-907）
- **涵盖朝代**：初唐、盛唐、中唐、晚唐

### 主要诗人
- 李白：917首诗作，917个地点
- 杜甫：1,153首诗作，1,153个地点
- 白居易：2,601首诗作，2,601个地点
- 元稹：785首诗作，785个地点
- 刘禹锡：860首诗作，860个地点

## 🛡️ 注意事项

- 确保 Python 3.8+ 和 Node.js 16+ 已安装
- 首次运行需要处理Excel数据，耗时约1-2分钟
- 地图加载需要网络连接（OpenStreetMap瓦片）
- 大量数据可能影响初始加载速度

## 🚀 部署建议

### 生产环境
1. 使用 Nginx 反向代理
2. 配置 SSL 证书
3. 使用 PM2 管理 Python 进程
4. 启用数据压缩和缓存

### 性能优化
1. 实现数据分页加载
2. 添加地图瓦片缓存
3. 使用 CDN 加速静态资源
4. 考虑使用数据库替代JSON文件

## 📄 许可证

MIT License

---

**开发完成时间**：2025年7月
**数据更新**：基于地理区分2.21文件夹Excel数据
**技术支持**：Claude Code